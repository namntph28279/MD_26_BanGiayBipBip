<html lang="en">

<head>
  <title>Đơn Hàng</title>
  <link rel="stylesheet" href="styles.css">

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <script src="https://code.highcharts.com/highcharts.js"></script>
  <style>
    body {
      margin: 7px auto auto;
    }

    /* Style cho các button */

    /* Style cho bảng sản phẩm */
    .table td {
      vertical-align: middle;
    }

    .table .table-actions a {
      margin-right: 5px;
    }

    .btn-cf {
      outline: unset !important;
    }

    .mess {
      position: relative;
      display: inline-block;
    }

    .mess::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 0;
      height: 1px;
      background-color: white;
      transition: width 0.5s ease-in-out;
    }

    .mess:hover::after {
      width: 100%;
    }

    .highcharts-figure,
    .highcharts-data-table table {
      min-width: 320px;
      max-width: 800px;
      height: 400px;
      margin: 1em auto;
    }
  </style>
</head>

<body class="bg-gray-200">
<div id="donHangAll" class="flex ">
  <!--Side Navbar-->
  <div class="bg-indigo-900 w-1/6">
    <div class=" bg-indigo-800">
      <div class=" text-xl text-gray-200 uppercase font-bold" style="padding: 33px;">Shop BipBip</div>
    </div>
    <a href="/statistic" class=" cursor-pointer mess ml-3 mt-3 w-10/12"
       style="text-decoration: none ">
      <div class="flex" style=" padding: 12px;">
        <div>
          <img class="w-5 h-5" src="analytics.png" alt="">
        </div>
        <div class="mx-3 text-sm text-gray-100 ">Thống kê</div>
      </div>
    </a>
    <a href="/home" class=" cursor-pointer mess ml-3 mt-3 w-10/12"
       style="display: flex;border-bottom-width: 1px; text-decoration: none ">
      <div class="flex" style=" padding: 12px;">
        <div>
          <img class="w-5 h-5" src="dashboard.png" alt="">
        </div>
        <div class="mx-3 text-sm text-gray-100 ">Đơn Hàng</div>
      </div>
      <span class="badge" style="color: white;font-size: 14px;">\{{donHangMoi}}</span>
    </a>


    <a href="/mess" class="cursor-pointer mess ml-3 mt-3 w-10/12" style="display: flex; text-decoration: none">
      <div class="flex" style="padding: 12px;">
        <div>
          <img class="w-5 h-5 " src="messages.png" alt="">
        </div>
        <div class="mx-3 text-sm text-gray-100 ">Tin Nhắn</div>
      </div>
      <span class="badge" style="color: white;font-size: 14px;">\{{tinNhanMoi}}</span>
    </a>

    <a href="/warehouse" class="cursor-pointer mess ml-3 mt-3 w-10/12" style="text-decoration: none">
      <div class="flex" style=" padding: 12px;">
        <div>
          <img class="w-5 h-5" src="kho.svg" alt="">
        </div>
        <div class="mx-3 text-sm text-gray-100">Kho Hàng</div>
      </div>
    </a>
  </div>
  <!--Side Navbar-->

  <!--Main area-->

  <div class="flex-1">
    <!--Top navbar-->
    <div>

      <div class="bg-white px-2 py-0.5 h-18 flex">
        <div class="left md:w-3/4 sm:w-1/3 flex p-3">
          <img src="person.png" class="w-10 h-10" alt="">
          <span class="block p-2">Admin</span>
        </div>
        <div class="right md:w-1/4 sm:w-2/3 flex  justify-content-end ">
          <a href="/login" style=" text-decoration: none; color: black; line-height: 58px; margin-right: 24px; ">Đăng xuất</a>
        </div>
      </div>
    </div>
    <!--Top navbar-->
    <div class="card-container flex m-7 space-x-6 " style=" height: 832px;  justify-content: center;">

      <div id="load" class="spinner-border text-primary"></div>

      <div class="card w-full" id="hienThidata" style="display: none">

        <div>
          <div style=" display: flex; line-height: 48px;  margin: 0 14px; justify-content: space-between;">
            <div style="display: flex">
              <div style="margin: 0 10px;">
                <button class="btn-cf default-selected" style=" padding: 0 8px;"
                        onclick="openOrder('choXacNhan')">
                  Chờ xác nhận
                </button>
                <span id="totalChoXacNhan" class="position-absolute translate-middle badge rounded-pill bg-danger"
                      style="color: white">
                  \{{choXacNhan.length}}
                </span>
              </div>

              <div style="margin: 0 10px;">
                <button class="btn-cf" style=" padding: 0 8px;" onclick="openOrder('choLayHang')">Đang chuẩn bị hàng
                </button>
                <span id="totalChoLayHang" class="position-absolute translate-middle badge rounded-pill bg-danger"
                      style="color: white">
                  \{{choLayHang.length}}
                </span>
              </div>

              <div style="margin: 0 10px;">
                <button class="btn-cf" style=" padding: 0 8px;" onclick="openOrder('choGiaoHang')">Chờ giao hàng
                </button>
                <span id="totalChoGiaoHang" class="position-absolute translate-middle badge rounded-pill bg-danger"
                      style="color: white">
                  \{{choGiaoHang.length}}
                </span>
              </div>

              <div style="margin: 0 10px;">
                <button class="btn-cf" style=" padding: 0 8px;" onclick="openOrder('daGiao')">Đã giao
                </button>
              </div>
            </div>
            <div style="display: flex">
              <div style="margin: 0 10px;">
                <button class="btn-cf" style=" padding: 0 8px;" onclick="openOrder('donHuy')">Đơn hủy</button>
              </div>

              <div style="margin: 0 10px;">
                <button class="btn-cf" style=" padding: 0 8px;" onclick="openOrder('traHang')">Trả hàng</button>
                <span id="totalTraHang" class="position-absolute translate-middle badge rounded-pill bg-danger"
                      style="color: white">
                  \{{traHang.length}}
                </span>
              </div>
              <div style="margin: 0 10px;">
                <button class="btn-cf" style=" padding: 0 8px;" onclick="openOrder('donHoan')">Đơn Hoàn</button>
              </div>
            </div>
          </div>
        </div>
        <div style="margin: 8px;color: #0008ff;display: flex;">
          <div>Đơn hàng</div>
          <div id="selectedText"></div>
        </div>

        <div style="height: 729px;
                      margin: 7px;
                      border-radius: 8px;
                      padding: 8px;
                      overflow: auto">
          <div id="choXacNhan" class=" status" style="padding: 0 8px;">
            <table class="table table-bordered ">
              <thead>
              <tr>
                <th style="text-align: center;width: 110px">STT</th>
                <th style="text-align: center;">Mã Đơn Hàng</th>
                <th style="text-align: center;">Tài khoản đặt</th>
                <th style="text-align: center;width: 120px">Số lượng</th>
                <th style="text-align: center;width: 130px">Giá tiền</th>
                <th style="text-align: center;width: 100px">Chi tiết</th>
                <th style="text-align: center;width: 145px;">Thao tác</th>
              </tr>
              </thead>
              <tbody>

              <tr v-for="(item, index) in choXacNhan">
                <td>\{{index+1}}</td>
                <td>\{{item._id}}</td>
                <td>\{{item.customer_email}}</td>
                <td>\{{item.total_quantity}}</td>
                <td>\{{formatPrice(item.total_amount)}}</td>
                <td>
                  <img width="50px" src="detail.png" class="btn btn-primary btn-sm"
                       @click="openModalXemChiTiet(choXacNhan[index])"/>
                </td>
                <td>
                  <img width="50px" src="tick.png" class="btn btn-success btn-sm"
                       @click="openModalXacNhanDon(choXacNhan[index])"/>
                  <img width="50px" src="close.png" class="btn btn-danger btn-sm"
                       @click="openModalHuyDon(choXacNhan[index])"/>
                </td>
              </tr>
              </tbody>
            </table>
          </div>

          <div id="choLayHang" class=" status" style="display:none ;padding: 0 8px;">
            <table class="table table-bordered ">
              <thead>
              <tr>
                <th style="text-align: center;width: 110px">STT</th>
                <th style="text-align: center;">Mã Đơn Hàng</th>
                <th style="text-align: center;">Tài khoản đặt</th>
                <th style="text-align: center;width: 120px">Số lượng</th>
                <th style="text-align: center;width: 130px">Giá tiền</th>
                <th style="text-align: center;width: 100px">Chi tiết</th>
                <th style="text-align: center;width: 145px;">Thao tác</th>
              </tr>
              </thead>
              <tbody>

              <tr v-for="(item, index) in choLayHang">
                <td>\{{index+1}}</td>
                <td>\{{item._id}}</td>
                <td>\{{item.customer_email}}</td>
                <td>\{{item.total_quantity}}</td>
                <td>\{{formatPrice(item.total_amount)}}</td>
                <td>
                  <img width="50px" src="detail.png" class="btn btn-primary btn-sm"
                       @click="openModalXemChiTiet(choLayHang[index])"/>
                </td>
                <td>
                  <img width="50px" src="tick.png" class="btn btn-success btn-sm"
                       @click="openModalXacNhanDon(choLayHang[index])"/>
                  <img width="50px" src="close.png" class="btn btn-danger btn-sm"
                       @click="openModalHuyDon(choLayHang[index])"/>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
          <div id="donHuy" class=" status" style="display:none ;padding: 0 8px;">
            <table class="table table-bordered ">
              <thead>
              <tr>
                <th style="text-align: center;width: 110px">STT</th>
                <th style="text-align: center;">Mã Đơn Hàng</th>
                <th style="text-align: center;">Tài khoản đặt</th>
                <th style="text-align: center;width: 120px">Số lượng</th>
                <th style="text-align: center;width: 130px">Giá tiền</th>
                <th style="text-align: center;width: 100px">Chi tiết</th>
              </tr>
              </thead>
              <tbody>

              <tr v-for="(item, index) in donHuy">
                <td>\{{index+1}}</td>
                <td>\{{item._id}}</td>
                <td>\{{item.customer_email}}</td>
                <td>\{{item.total_quantity}}</td>
                <td>\{{formatPrice(item.total_amount)}}</td>
                <td>
                  <img width="50px" src="detail.png" class="btn btn-primary btn-sm"
                       @click="openModalXemChiTiet(donHuy[index])"/>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
          <div id="choGiaoHang" class=" status" style="display:none ;padding: 0 8px;">
            <table class="table table-bordered ">
              <thead>
              <tr>
                <th style="text-align: center;width: 110px">STT</th>
                <th style="text-align: center;">Mã Đơn Hàng</th>
                <th style="text-align: center;">Tài khoản đặt</th>
                <th style="text-align: center;width: 120px">Số lượng</th>
                <th style="text-align: center;width: 130px">Giá tiền</th>
                <th style="text-align: center;width: 100px">Chi tiết</th>
                <th style="text-align: center;width: 145px;">Thao tác</th>
              </tr>
              </thead>
              <tbody>

              <tr v-for="(item, index) in choGiaoHang">
                <td>\{{index+1}}</td>
                <td>\{{item._id}}</td>
                <td>\{{item.customer_email}}</td>
                <td>\{{item.total_quantity}}</td>
                <td>\{{formatPrice(item.total_amount)}}</td>
                <td>
                  <img width="50px" src="detail.png" class="btn btn-primary btn-sm"
                       @click="openModalXemChiTiet(choGiaoHang[index])"/>
                </td>
                <td>
                  <img width="50px" src="tick.png" class="btn btn-success btn-sm"
                       @click="openModalXacNhanDon(choGiaoHang[index])"/>
                  <img width="50px" src="close.png" class="btn btn-danger btn-sm"
                       @click="openModalHuyDon(choGiaoHang[index])"/>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
          <div id="daGiao" class=" status" style="display:none ;padding: 0 8px;">
            <table class="table table-bordered ">
              <thead>
              <tr>
                <th style="text-align: center;width: 110px">STT</th>
                <th style="text-align: center;">Mã Đơn Hàng</th>
                <th style="text-align: center;">Tài khoản đặt</th>
                <th style="text-align: center;width: 120px">Số lượng</th>
                <th style="text-align: center;width: 130px">Giá tiền</th>
                <th style="text-align: center;width: 100px">Chi tiết</th>
              </tr>
              </thead>
              <tbody>

              <tr v-for="(item, index) in daGiao">
                <td>\{{index+1}}</td>
                <td>\{{item._id}}</td>
                <td>\{{item.customer_email}}</td>
                <td>\{{item.total_quantity}}</td>
                <td>\{{formatPrice(item.total_amount)}}</td>
                <td>
                  <img width="50px" src="detail.png" class="btn btn-primary btn-sm"
                       @click="openModalXemChiTiet(daGiao[index])"/>
                </td>
              </tr>
              </tbody>
            </table>
          </div>

          <div id="traHang" class=" status" style="display:none ;padding: 0 8px;">
            <table class="table table-bordered ">
              <thead>
              <tr>
                <th style="text-align: center;width: 110px">STT</th>
                <th style="text-align: center;">Mã Đơn Hàng</th>
                <th style="text-align: center;">Tài khoản đặt</th>
                <th style="text-align: center;width: 120px">Số lượng</th>
                <th style="text-align: center;width: 130px">Giá tiền</th>
                <th style="text-align: center;width: 100px">Chi tiết</th>
                <th style="text-align: center;width: 145px;">Thao tác</th>
              </tr>
              </thead>
              <tbody>

              <tr v-for="(item, index) in traHang">
                <td>\{{index+1}}</td>
                <td>\{{item._id}}</td>
                <td>\{{item.customer_email}}</td>
                <td>\{{item.total_quantity}}</td>
                <td>\{{formatPrice(item.total_amount)}}</td>
                <td>
                  <img width="50px" src="detail.png" class="btn btn-primary btn-sm"
                       @click="openModalXemChiTiet(traHang[index])"/>
                </td>
                <td>
                  <img width="50px" src="tick.png" class="btn btn-success btn-sm"
                       @click="openModalXacNhanDon(traHang[index])"/>
                  <img width="50px" src="close.png" class="btn btn-danger btn-sm"
                       @click="openModalHuyDon(traHang[index])"/>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
          <div id="donHoan" class=" status" style="display:none ;padding: 0 8px;">
            <table class="table table-bordered ">
              <thead>
              <tr>
                <th style="text-align: center;width: 110px">STT</th>
                <th style="text-align: center;">Mã Đơn Hàng</th>
                <th style="text-align: center;">Tài khoản đặt</th>
                <th style="text-align: center;width: 120px">Số lượng</th>
                <th style="text-align: center;width: 130px">Giá tiền</th>
                <th style="text-align: center;width: 100px">Chi tiết</th>
              </tr>
              </thead>
              <tbody>

              <tr v-for="(item, index) in donHoan">
                <td>\{{index+1}}</td>
                <td>\{{item._id}}</td>
                <td>\{{item.customer_email}}</td>
                <td>\{{item.total_quantity}}</td>
                <td>\{{formatPrice(item.total_amount)}}</td>
                <td>
                  <img width="50px" src="detail.png" class="btn btn-primary btn-sm"
                       @click="openModalXemChiTiet(donHoan[index])"/>
                </td>

              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>


    </div>
  </div>

  <div class="modal fade" id="xemChiTiet" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
       aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Thông tin chi tiết</h5>
          <button type="button" class="close" @click="closeModalXemChiTiet" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div style="margin-bottom: 2px" class="modal-body">
          <div>
            Họ và tên: \{{dataXemChiTiet.userName}} <br>
            Số điện thoại: \{{dataXemChiTiet.phone}}<br>
            Địa chỉ: \{{dataXemChiTiet.address}}
          </div>
          <div v-for="(item,index) in dataXemChiTiet.products" style="display: flex;padding: 12px">
            <img style="height: 80px; margin-right: 8px;width: 80px;  border-radius: 8px;"
                 :src=(item.img_product) alt="">
            <div style="width: 100%">
              <div style="font-weight: 700;font-size: 16px">
                \{{item.name_Product}}
              </div>
              <div style="display: flex;justify-content: space-between;">

                <div style="display: flex">
                  <div style="color:#656769; margin-right: 7px">
                    \{{item.name_Color}}
                  </div>
                  <div style="color:#656769;">
                    \{{item.name_Size}}
                  </div>
                </div>

                <div>
                  x \{{item.quantityProduct}}
                </div>
              </div>
              <div style="text-align: end;color: red">
                \{{formatPrice(item.name_Price)}}

              </div>
            </div>
          </div>

          <div style="display: flex; text-align: end;justify-content: end;">
            Tổng tiền:
            <div style="color: red;font-weight: 700;margin-left: 7px;"> \{{formatPrice(dataXemChiTiet.total_All)}}</div>
          </div>
          <div style="display: flex; text-align: end;justify-content: end;">
            Ngày đặt: \{{formatDate(dataXemChiTiet.order_date)}}
          </div>

          <div style="display: flex;" v-if="dataXemChiTiet.lyDoHuyDon">
            Lý do hủy:
            <div style="font-weight: 600;margin-left: 7px;"> \{{dataXemChiTiet.lyDoHuyDon}}</div>
          </div>
        </div>

      </div>
    </div>
  </div>
  <div class="modal fade" id="xacNhanDon" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
       aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel" v-if="dataXacNhanDon.status === 5">Đồng ý trả hàng tài
            khooản: \{{dataXacNhanDon.customer_email}}?</h5>
          <h5 class="modal-title" id="exampleModalLabel" v-else>Xác nhận đơn tài khooản: \{{dataXacNhanDon.customer_email}}?</h5>
          <button type="button" class="close" @click="closeModalXacNhanDon" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div style="margin-bottom: 2px" class="modal-body">
          <div>
            Họ và tên: \{{dataXacNhanDon.userName}} <br>
            Số điện thoại: \{{dataXacNhanDon.phone}}<br>
            Địa chỉ: \{{dataXacNhanDon.address}}
          </div>
          <div v-for="(item,index) in dataXacNhanDon.products" style="display: flex;padding: 12px">
            <img style="height: 80px; margin-right: 8px;width: 80px;  border-radius: 8px;"
                 :src=(item.img_product) alt="">
            <div style="width: 100%">
              <div style="font-weight: 700;font-size: 16px">
                \{{item.name_Product}}
              </div>
              <div style="display: flex;justify-content: space-between;">

                <div style="display: flex">
                  <div style="color:#656769; margin-right: 7px">
                    \{{item.name_Color}}
                  </div>
                  <div style="color:#656769;">
                    \{{item.name_Size}}
                  </div>
                </div>

                <div>
                  x \{{item.quantityProduct}}
                </div>
              </div>
              <div style="text-align: end;color: red">
                \{{formatPrice(item.name_Price)}}

              </div>
            </div>
          </div>

          <div style="display: flex; text-align: end;justify-content: end;">
            Tổng tiền:
            <div style="color: red;font-weight: 700;margin-left: 7px;"> \{{formatPrice(dataXacNhanDon.total_All)}}</div>
          </div>
          <div style="display: flex; text-align: end;justify-content: end;">
            Ngày đặt: \{{formatDate(dataXacNhanDon.order_date)}}
          </div>
          <div style="display: flex;" v-if="dataXacNhanDon.lyDoHuyDon">
            Lý do hủy:
            <div style="font-weight: 600;margin-left: 7px;"> \{{dataXacNhanDon.lyDoHuyDon}}</div>
          </div>
        </div>


        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            Thoát
          </button>
          <form @submit.prevent="submitXacNhanDon">
            <button type="submit" class="btn btn-primary">Xác nhận</button>
          </form>
        </div>

      </div>
    </div>
  </div>
  <div class="modal fade" id="huyDon" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
       aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel" v-if="dataHuyDon.status === 5">Từ chối trả hàng tài khoản: \{{dataHuyDon.customer_email}}?</h5>
          <h5 class="modal-title" id="exampleModalLabel" v-else>Hủy đơn tài khoản: \{{dataHuyDon.customer_email}}?</h5>
          <button type="button" class="close" @click="closeModalHuyDon" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div>
            Họ và tên: \{{dataHuyDon.userName}} <br>
            Số điện thoại: \{{dataHuyDon.phone}}<br>
            Địa chỉ: \{{dataHuyDon.address}}
          </div>
          <div v-for="(item,index) in dataHuyDon.products" style="display: flex;padding: 12px">
            <img style="height: 80px; margin-right: 8px;width: 80px;  border-radius: 8px;"
                 :src=(item.img_product) alt="">
            <div style="width: 100%">
              <div style="font-weight: 700;font-size: 16px">
                \{{item.name_Product}}
              </div>
              <div style="display: flex;justify-content: space-between;">

                <div style="display: flex">
                  <div style="color:#656769; margin-right: 7px">
                    \{{item.name_Color}}
                  </div>
                  <div style="color:#656769;">
                    \{{item.name_Size}}
                  </div>
                </div>

                <div>
                  x \{{item.quantityProduct}}
                </div>
              </div>
              <div style="text-align: end;color: red">
                \{{formatPrice(item.name_Price)}}

              </div>
            </div>
          </div>

          <div style="display: flex; text-align: end;justify-content: end;">
            Tổng tiền:
            <div style="color: red;font-weight: 700;margin-left: 7px;"> \{{formatPrice(dataHuyDon.total_All)}}</div>
          </div>
          <div style="display: flex; text-align: end;justify-content: end;margin-bottom: 8px;">
            Ngày đặt: \{{formatDate(dataHuyDon.order_date)}}
          </div>
          <div style="display: flex;" v-if="dataHuyDon.lyDoHuyDon">
            Lý do hủy:
            <div style="font-weight: 600;margin-left: 7px;"> \{{dataHuyDon.lyDoHuyDon}}</div>
          </div>


          <form @submit.prevent="submitHuyDon" class="mb-3">
            <div class="form-group">

              <input type="text" class="form-control"
                     v-model="formData.noiDung" required
                     placeholder="Vui lòng nhập lý do ">
            </div>
            <button type="button" class="btn btn-secondary"
                    data-dismiss="modal"> Thoát
            </button>
            <button type="submit" class="btn btn-danger">Xác nhận</button>
          </form>

        </div>
      </div>
    </div>
  </div>
</div>

</body>
<script>
  let selectedCity = null;
  let addedTexts = [];
  let dataCart = []


  window.onload = function () {
    const defaultButton = document.querySelector('.btn-cf.default-selected');
    defaultButton.click();
  };

  function NotificaionClient() {
    fetch('https://exp.host/--/api/v2/push/send', {
      mode: 'no-cors',
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        to: 'ExponentPushToken[l9_Yr-DKiVXVowKIC5pO_D]',
        title: 'ShopBipBip',
        body: 'Hello'
      })
    });
  }

  function openOrder(orderName) {
    let i;
    const x = document.getElementsByClassName("status");
    const buttons = document.querySelectorAll(".btn-cf");
    const buttonText = document.querySelector('.btn-cf[onclick="openOrder(\'' + orderName + '\')"]');
    if (!addedTexts.includes(orderName)) {
      selectedCity = orderName
      addedTexts = orderName
      const selectedText = document.getElementById("selectedText");
      selectedText.textContent = "  > " + buttonText.innerText;
    }
    for (i = 0; i < buttons.length; i++) {
      buttons[i].style.background = "white";
    }
    for (i = 0; i < x.length; i++) {
      x[i].style.display = "none";
    }
    buttonText.style.background = "rgba(229, 231, 235, 255)"
    document.getElementById(orderName).style.display = "block";
  }


</script>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2"></script>

<script>
  var vmCart = new Vue({
    el: '#donHangAll',
    data: {
      choXacNhan: {},
      choLayHang: {},
      choGiaoHang: {},
      daGiao: {},
      donHuy: {},
      traHang: {},
      donHoan: {},
      showModal: false,

      dataXemChiTiet: {},
      dataXacNhanDon: {},
      dataHuyDon: {},
      tinNhanMoi: 0,
      donHangMoi: 0,
      formData: {
        noiDung: ''
      }
    },
    mounted() {
      const socket = io();
      const self = this;
      socket.on('server-send', () => {
        self.GetAllDataChat();
        self.GetDataCart();
      });
      this.socket = socket;

    },
    beforeDestroy() {
      const socket = io();
      if (socket) {
        this.socket.disconnect();
      }
    },
    methods: {
      formatDate(vale) {
        const date = new Date(vale);
        const year = date.getFullYear();
        const month = date.getMonth() + 1;
        const day = date.getDate();
        return `${day}-${month}-${year}`;
      },
      formatPrice(value) {
        let val = (value / 1).toFixed(0);
        return val.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + " đ";
      },
      openModalXemChiTiet(data) {
        this.dataXemChiTiet = data
        $('#xemChiTiet').modal('show');
      },
      closeModalXemChiTiet() {
        this.dataXemChiTiet = {};
        $('#xemChiTiet').modal('hide');
      },

      openModalXacNhanDon(data) {
        this.dataXacNhanDon = data
        $('#xacNhanDon').modal('show');
      },
      closeModalXacNhanDon() {
        this.dataXacNhanDon = {};
        $('#xacNhanDon').modal('hide');
      },

      openModalHuyDon(data) {
        this.dataHuyDon = data
        $('#huyDon').modal('show');
      },
      closeModalHuyDon() {
        this.dataHuyDon = {};
        $('#huyDon').modal('hide');
      },

      GetDataCart: function () {
        var self = this;
        fetch('/loadData', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          },
        })
            .then(response => response.json())
            .then(data => {
              self.choXacNhan = data[0]
              self.choLayHang = data[1]
              self.choGiaoHang = data[2]
              self.daGiao = data[3]
              self.donHuy = data[4]
              self.traHang = data[5]
              self.donHoan = data[6]
              self.donHangMoi = data[0].length
              var load = document.getElementById("load")
              var duLieu = document.getElementById("hienThidata")

              load.style.display = "none"
              duLieu.style.display = "block"
            })
            .catch(error => {
              console.error(error);
            });
      },
      GetAllDataChat: function () {
        var self = this;
        fetch('/chatAllShop', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          }
        })
            .then(response => response.json())
            .then(data => {
              self.tinNhanMoi = data.filter(item => item.status === true).length
            })
            .catch(error => {
              console.error(error);
            });
      },

      submitXacNhanDon() {
        const self = this;
        const socket = io();

        fetch(`/order/status/Comfig/${self.dataXacNhanDon._id}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
        })
            .then(response => response.json())
            .then(data => {
              if (data === true) {
                socket.emit('client-send');
                self.dataXacNhanDon = {};
                $('#xacNhanDon').modal('hide');
              }
            })
            .catch(error => {
              console.error(error);
            });
      },

      submitHuyDon() {
        const self = this;
        const socket = io();

        fetch(`/order/status/${self.dataHuyDon._id}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(self.formData)
        })
            .then(response => response.json())
            .then(data => {
              if (data === true) {
                socket.emit('client-send');
                self.dataHuyDon = {};
                self.formData.noiDung = '';
                $('#huyDon').modal('hide');
              }
            })
            .catch(error => {
              console.error(error);
            });
      }
    }

  });
  vmCart.GetAllDataChat();
  vmCart.GetDataCart();

</script>
</html>